"use strict";

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var ObjectId = require('bson-objectid');

var Url = require('url-parse');

var convertHrtime = require('convert-hrtime');

var cookie = require('cookie');

var creditCardType = require('credit-card-type');

var debug = require('debug')('parse-request');

var hrtime = require('browser-process-hrtime');

var httpHeaders = require('http-headers');

var isArrayBuffer = require('is-array-buffer');

var isBuffer = require('is-buffer');

var isStream = require('is-stream');

var isUUID = require('is-uuid');

var ms = require('ms');

var noCase = require('no-case');

var rfdc = require('rfdc');

var safeStringify = require('fast-safe-stringify');

var sensitiveFields = require('sensitive-fields'); // https://github.com/cabinjs/request-received


var startTime = Symbol.for('request-received.startTime');
var pinoHttpStartTime = Symbol.for('pino-http.startTime');
var disableBodyParsingSymbol = Symbol.for('parse-request.disableBodyParsing');
var disableFileParsingSymbol = Symbol.for('parse-request.disableFileParsing');
var hashMapIds = {
  _id: true,
  id: true
};
var regexId = /_id$/;

function maskArray(obj, options) {
  var arr = [];
  var _iteratorNormalCompletion = true;
  var _didIteratorError = false;
  var _iteratorError = undefined;

  try {
    for (var _iterator = obj.entries()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
      var _step$value = _slicedToArray(_step.value, 2),
          i = _step$value[0],
          element = _step$value[1];

      arr[i] = maskSpecialTypes(element, options);
    }
  } catch (err) {
    _didIteratorError = true;
    _iteratorError = err;
  } finally {
    try {
      if (!_iteratorNormalCompletion && _iterator.return != null) {
        _iterator.return();
      }
    } finally {
      if (_didIteratorError) {
        throw _iteratorError;
      }
    }
  }

  return arr;
}

function maskSpecialTypes(obj, options) {
  options = Object.assign({
    maskBuffers: true,
    maskStreams: true,
    checkObjectId: true
  }, options);
  if (_typeof(obj) !== 'object') return obj; // we need to return an array if passed an array

  if (Array.isArray(obj)) return maskArray(obj, options); // if it was a bson objectid return early

  if (options.checkObjectId && ObjectId.isValid(obj)) return obj.toString(); // check if it was a stream

  if (options.maskStreams && isStream(obj)) return {
    type: 'Stream'
  }; // check if it was a buffer or array buffer
  // before iterating over the object's keys

  if (options.maskBuffers) {
    if (isBuffer(obj)) return {
      type: 'Buffer',
      byteLength: obj.byteLength
    };
    if (isArrayBuffer(obj)) return {
      type: 'ArrayBuffer',
      byteLength: obj.byteLength
    };
  } // we need to return an object if passed an object


  var masked = {}; // for...in is much faster than Object.entries or any alternative
  // TODO: we should optimize this further in the future

  for (var key in obj) {
    if (_typeof(obj[key]) === 'object') {
      if (Array.isArray(obj[key])) {
        masked[key] = maskSpecialTypes(obj[key], options);
      } else if (options.maskStreams && isStream(obj[key])) {
        masked[key] = {
          type: 'Stream'
        };
      } else if (options.maskBuffers && isBuffer(obj[key])) {
        masked[key] = {
          type: 'Buffer',
          byteLength: obj[key].byteLength
        };
      } else if (options.maskBuffers && isArrayBuffer(obj[key])) {
        masked[key] = {
          type: 'ArrayBuffer',
          byteLength: obj[key].byteLength
        };
      } else {
        masked[key] = maskSpecialTypes(obj[key], options);
      }
    } else {
      masked[key] = obj[key];
    }
  }

  return masked;
}

function pick(object, keys) {
  return keys.reduce(function (obj, key) {
    if (object && Object.prototype.hasOwnProperty.call(object, key)) {
      obj[key] = object[key];
    }

    return obj;
  }, {});
}

function isNull(val) {
  return val === null;
}

function isUndefined(val) {
  return typeof val === 'undefined';
}

function isObject(val) {
  return _typeof(val) === 'object' && val !== null && !Array.isArray(val);
}

function isString(val) {
  return typeof val === 'string';
} // <https://github.com/braintree/credit-card-type/issues/90>


function isCreditCard(val) {
  var digits = val.replace(/\D/g, '');
  var types = creditCardType(digits);
  if (!Array.isArray(types) || types.length === 0) return false;
  var match = false;
  var _iteratorNormalCompletion2 = true;
  var _didIteratorError2 = false;
  var _iteratorError2 = undefined;

  try {
    for (var _iterator2 = types[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
      var type = _step2.value;
      if (match) break; // can match any one of the lengths

      if (!Array.isArray(type.lengths) || type.lengths.length === 0) continue;

      for (var l = 0; l < type.lengths.length; l++) {
        var len = type.lengths[l];

        if (Number.isFinite(len) && len === digits.length) {
          match = true;
          break;
        }
      }
    }
  } catch (err) {
    _didIteratorError2 = true;
    _iteratorError2 = err;
  } finally {
    try {
      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {
        _iterator2.return();
      }
    } finally {
      if (_didIteratorError2) {
        throw _iteratorError2;
      }
    }
  }

  return match;
}

function isID(val, options) {
  // if it was an objectid return early
  if (options.checkObjectId && ObjectId.isValid(val)) return true; // if it was a cuid return early
  // <https://github.com/ericelliott/cuid/issues/88#issuecomment-339848922>

  if (options.checkCuid && val.indexOf('c') === 0 && val.length >= 7) return true; // if it was a uuid v1-5 return early

  if (options.checkUUID && isUUID.anyNonNil(val)) return true;
  return false;
}

function maskString(key, val, props, options) {
  var isKeyString = isString(key);

  if (options.isHeaders) {
    // headers are case-insensitive
    props = props.map(function (prop) {
      return prop.toLowerCase();
    });

    if (props.includes('referer') || props.includes('referrer')) {
      if (!props.includes('referer')) props.push('referer');
      if (!props.includes('referrer')) props.push('referrer');
    }
  }

  var notIncludedInProps = !isKeyString || !props.includes(key);

  if (!options.isHeaders) {
    // check if it closely resembles a primary ID and return early if so
    if (isKeyString && options.checkId) {
      // _id
      // id
      // ID
      // Id
      if (hashMapIds[key.toLowerCase()]) return val; // product_id
      // product-id
      // product[id]
      // productId
      // productID

      var snakeCase = noCase(key, null, '_');
      if (regexId.test(snakeCase)) return val;
    } // if it was an objectid, cuid, or uuid return early


    if (isID(val, options) && notIncludedInProps) return val; // if it was a credit card then replace all digits with asterisk

    if (options.maskCreditCards && isCreditCard(val)) return val.replace(/[^\D\s]/g, '*');
  }

  if (notIncludedInProps) return val; // replace only the authentication <credentials> portion with asterisk
  // Authorization: <type> <credentials>

  if (options.isHeaders && key === 'authorization') return "".concat(val.split(' ')[0], " ").concat(val.slice(val.indexOf(' ') + 1).replace(/./g, '*'));
  return val.replace(/./g, '*');
}

function headersToLowerCase(headers) {
  if (_typeof(headers) !== 'object' || Array.isArray(headers)) return headers;
  var lowerCasedHeaders = {};

  for (var header in headers) {
    if (isString(headers[header])) lowerCasedHeaders[header.toLowerCase()] = headers[header];
  }

  return lowerCasedHeaders;
}

function maskProps(obj, props, options) {
  options = Object.assign({
    maskCreditCards: true,
    isHeaders: false,
    checkId: true,
    checkCuid: true,
    checkObjectId: true,
    checkUUID: true
  }, options);
  if (isString(obj)) return maskString(null, obj, props, options); // for...in is much faster than Object.entries or any alternative

  for (var key in obj) {
    if (_typeof(obj[key]) === 'object') obj[key] = maskProps(obj[key], props, options);else if (isString(obj[key])) obj[key] = maskString(key, obj[key], props, options);
  }

  return obj;
} // inspired by raven's parseRequest
// eslint-disable-next-line complexity


var parseRequest = function parseRequest() {
  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var start = hrtime();
  var id = new ObjectId();
  config = Object.assign({
    req: false,
    ctx: false,
    responseHeaders: '',
    userFields: ['id', 'email', 'full_name', 'ip_address'],
    sanitizeFields: sensitiveFields,
    sanitizeHeaders: ['authorization'],
    maskCreditCards: true,
    maskBuffers: true,
    maskStreams: true,
    checkId: true,
    checkCuid: true,
    checkObjectId: true,
    checkUUID: true,
    // <https://github.com/davidmarkclements/rfdc>
    rfdc: {
      proto: false,
      circles: false
    },
    parseBody: true,
    parseFiles: true
  }, config);
  var clone = rfdc(config.rfdc);
  var _config = config,
      req = _config.req,
      ctx = _config.ctx,
      responseHeaders = _config.responseHeaders,
      userFields = _config.userFields,
      sanitizeFields = _config.sanitizeFields,
      sanitizeHeaders = _config.sanitizeHeaders,
      maskCreditCards = _config.maskCreditCards,
      maskBuffers = _config.maskBuffers,
      maskStreams = _config.maskStreams,
      checkId = _config.checkId,
      checkCuid = _config.checkCuid,
      checkObjectId = _config.checkObjectId,
      checkUUID = _config.checkUUID,
      parseBody = _config.parseBody,
      parseFiles = _config.parseFiles; // do not allow both `req` and `ctx` to be specified

  if (req && ctx) throw new Error('You must either use `req` (Express/Connect) or `ctx` (Koa) option, but not both');
  var nodeReq = ctx ? ctx.req : req ? req : {};
  var maskPropsOptions = {
    maskCreditCards: maskCreditCards,
    checkId: checkId,
    checkCuid: checkCuid,
    checkObjectId: checkObjectId,
    checkUUID: checkUUID
  };
  var maskSpecialTypesOptions = {
    maskBuffers: maskBuffers,
    maskStreams: maskStreams,
    checkObjectId: checkObjectId
  };
  var requestHeaders = nodeReq.headers;
  var headers;
  if (requestHeaders) headers = maskProps(headersToLowerCase(requestHeaders), sanitizeHeaders, {
    isHeaders: true
  });
  var method;
  if (ctx) method = ctx.method;else if (req) method = req.method; // inspired from `preserve-qs` package

  var originalUrl;
  if (ctx) originalUrl = ctx.originalUrl || ctx.url;else if (req) originalUrl = req.originalUrl || req.url;
  var query;
  var absoluteUrl;

  if (originalUrl) {
    originalUrl = new Url(originalUrl, {}); // parse query, path, and origin to prepare absolute Url

    query = Url.qs.parse(originalUrl.query);
    var path = originalUrl.origin === 'null' ? originalUrl.pathname : "".concat(originalUrl.origin).concat(originalUrl.pathname);
    var qs = Url.qs.stringify(query, true);
    absoluteUrl = path + qs;
  } // default to the user object


  var user = {};
  var parsedUser;
  if (ctx && isObject(ctx.state.user)) parsedUser = ctx.state.user;else if (req && isObject(req.user)) parsedUser = req.user;

  if (parsedUser) {
    try {
      user = typeof parsedUser.toJSON === 'function' ? parsedUser.toJSON() : typeof parsedUser.toObject === 'function' ? parsedUser.toObject() : clone(parsedUser);
    } catch (err) {
      debug(err);

      try {
        user = JSON.parse(safeStringify(parsedUser));
      } catch (err) {
        debug(err);
      }
    }
  }

  var ip = ctx ? ctx.ip : req ? req.ip : null;
  if (ip && !isString(user.ip_address)) user.ip_address = ip;
  if (user && Array.isArray(userFields) && userFields.length > 0) user = pick(user, userFields); // recursively search through user and filter out passwords from it

  if (user) user = maskProps(user, sanitizeFields, maskPropsOptions);
  var body;
  var originalBody = ctx ? ctx.request._originalBody || ctx.request.body : req ? req._originalBody || req.body : null;

  if (originalBody && parseBody && !nodeReq[disableBodyParsingSymbol]) {
    //
    // recursively search through body and filter out passwords from it
    // <https://github.com/niftylettuce/frisbee/issues/68>
    // <https://github.com/bitinn/node-fetch/blob/master/src/request.js#L75-L78>
    //
    if (!['GET', 'HEAD'].includes(method) && !isUndefined(originalBody)) body = clone(maskBuffers || maskStreams ? maskSpecialTypes(originalBody, maskSpecialTypesOptions) : originalBody);
    body = maskProps(body, sanitizeFields, maskPropsOptions);
    if (!isUndefined(body) && !isNull(body) && !isString(body)) body = safeStringify(body);
  } // parse the cookies (if any were set)


  var cookies;
  if (headers && headers.cookie) cookies = cookie.parse(headers.cookie);
  var result = {
    id: id.toString(),
    //
    // NOTE: regarding the naming convention of `timestamp`, it seems to be the
    // most widely used and supported property name across logging services
    //
    timestamp: id.getTimestamp().toISOString()
  };
  if (ctx || req) result.request = {};
  if (method) result.request.method = method;
  if (query) result.request.query = query;
  if (headers) result.request.headers = headers;
  if (cookies) result.request.cookies = cookies;
  if (absoluteUrl) result.request.url = absoluteUrl;
  if (user) result.user = user;
  if (originalBody && parseBody && body && !nodeReq[disableBodyParsingSymbol]) result.request.body = body; //
  // Also note that there is no standard for setting a request received time.
  //
  // Examples:
  //
  // 1) koa-req-logger uses `ctx.start`
  // <https://github.com/DrBarnabus/koa-req-logger/blob/master/src/index.ts#L198>
  //
  // 2) morgan uses `req._startAt` and `req._startTime` which are not
  // req._startAt = process.hrtime()
  // req._startTime = new Date()
  // <https://github.com/expressjs/morgan/blob/master/index.js#L500-L508>
  //
  // 3) pino uses `Symbol('startTime')` but it does not expose it easily
  // <https://github.com/pinojs/pino-http/issues/65>
  //
  // 4) response-time does not expose anything
  // <https://github.com/expressjs/response-time/pull/18>
  //
  // Therefore we created `request-received` middleware that is required
  // to be used in order for `request.timestamp` to be populated with ISO-8601
  // <https://github.com/cabinjs/request-received>
  //
  // We also opened the following PR's in an attempt to make this a drop-in:
  //
  // * https://github.com/pinojs/pino-http/pull/67
  // * https://github.com/expressjs/morgan/pull/201
  // * https://github.com/expressjs/response-time/pull/20
  // * https://github.com/DataDog/node-connect-datadog/pull/7
  // * https://github.com/DrBarnabus/koa-req-logger/pull/2
  //
  // add request.timestamp (parse req[$x] variable)

  if (nodeReq[startTime] instanceof Date) result.request.timestamp = nodeReq[startTime].toISOString();else if (typeof nodeReq[startTime] === 'number') result.request.timestamp = new Date(nodeReq[startTime]).toISOString();else if (typeof nodeReq[pinoHttpStartTime] === 'number') result.request.timestamp = new Date(nodeReq[pinoHttpStartTime]).toISOString();else if (nodeReq._startTime instanceof Date) result.request.timestamp = nodeReq._startTime.toISOString();else if (typeof nodeReq._startTime === 'number') result.request.timestamp = new Date(nodeReq._startTime).toISOString(); //
  // conditionally add a `response` object if and only if
  // `responseHeaders` option was passed, and it was a non-empty string or object
  //

  if (isObject(responseHeaders) && Object.keys(responseHeaders).length > 0) {
    result.response = {};
    result.response.headers = clone(responseHeaders);
  } else if (isString(responseHeaders)) {
    // <https://github.com/nodejs/node/issues/28302>
    var parsedHeaders = httpHeaders(responseHeaders);
    result.response = {};

    if (isObject(parsedHeaders.headers)) {
      result.response.headers = parsedHeaders.headers; // parse the status line
      // <https://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6.1>

      if (isObject(parsedHeaders.version) && typeof parsedHeaders.version.major === 'number' && typeof parsedHeaders.version.minor === 'number') result.response.http_version = "".concat(parsedHeaders.version.major, ".").concat(parsedHeaders.version.minor);
      if (typeof parsedHeaders.statusCode === 'number') result.response.status_code = parsedHeaders.statusCode;
      if (isString(parsedHeaders.statusMessage)) result.response.reason_phrase = parsedHeaders.statusMessage;
    } else {
      result.response.headers = parsedHeaders;
    }
  }

  if (result.response && result.response.headers) {
    result.response.headers = maskProps(headersToLowerCase(result.response.headers), sanitizeHeaders, {
      isHeaders: true
    });

    if (result.response.headers && Object.keys(result.response.headers).length === 0) {
      delete result.response;
    } else {
      // add response.timestamp (response Date header)
      try {
        if (result.response.headers.date) result.response.timestamp = new Date(result.response.headers.date).toISOString();
      } catch (err) {
        debug(err);
      } // add response.duration (parsed from response X-Response-Time header)


      try {
        if (result.response.headers['x-response-time']) {
          var duration = ms(result.response.headers['x-response-time']);
          if (typeof duration === 'number') result.response.duration = duration;
        }
      } catch (err) {
        debug(err);
      }
    }
  } // add request's id if available from `req.id`


  var requestId;

  if (ctx) {
    if (isString(ctx.id)) requestId = ctx.id;else if (isString(ctx.request.id)) requestId = ctx.request.id;else if (isString(ctx.req.id)) requestId = ctx.req.id;else if (isString(ctx.state.reqId)) requestId = ctx.state.reqId;else if (isString(ctx.state.id)) requestId = ctx.state.id;
  } else if (req && isString(req.id)) {
    requestId = req.id;
  } // TODO: we should probably validate this id somehow
  // (e.g. like we do with checking if cuid or uuid or objectid)


  if (requestId) result.request.id = requestId;else if (headers && headers['x-request-id']) result.request.id = headers['x-request-id']; // add httpVersion if possible (server-side only)

  var httpVersion = nodeReq.httpVersion,
      httpVersionMajor = nodeReq.httpVersionMajor,
      httpVersionMinor = nodeReq.httpVersionMinor;
  if (isString(httpVersion)) result.request.http_version = httpVersion;else if (typeof httpVersionMajor === 'number' && typeof httpVersionMinor === 'number' || isString(httpVersionMajor) && isString(httpVersionMinor)) result.request.http_version = "".concat(httpVersionMajor, ".").concat(httpVersionMinor); // parse `req.file` and `req.files` for multer v1.x and v2.x

  if (parseFiles && !nodeReq[disableFileParsingSymbol]) {
    // koa-multer@1.x binded to `ctx.req`
    // and then koa-multer was forked by @niftylettuce to @koajs/multer
    // and the 2.0.0 release changed it so it uses `ctx.file` and `ctx.files`
    // (so it doesn't bind to the `ctx.req` Node original request object
    // <https://github.com/koa-modules/multer/pull/15>
    var file;
    var files;

    if (ctx) {
      file = ctx.file || ctx.request.file || ctx.req.file;
      files = ctx.files || ctx.request.files || ctx.req.files;
    } else if (req) {
      file = req.file;
      files = req.files;
    }

    if (_typeof(file) === 'object') result.request.file = safeStringify(clone(maskSpecialTypes(file, maskSpecialTypesOptions)));
    if (_typeof(files) === 'object') result.request.files = safeStringify(clone(maskSpecialTypes(files, maskSpecialTypesOptions)));
  }

  result.duration = convertHrtime(hrtime(start)).milliseconds;
  return result;
};

module.exports = parseRequest;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJPYmplY3RJZCIsInJlcXVpcmUiLCJVcmwiLCJjb252ZXJ0SHJ0aW1lIiwiY29va2llIiwiY3JlZGl0Q2FyZFR5cGUiLCJkZWJ1ZyIsImhydGltZSIsImh0dHBIZWFkZXJzIiwiaXNBcnJheUJ1ZmZlciIsImlzQnVmZmVyIiwiaXNTdHJlYW0iLCJpc1VVSUQiLCJtcyIsIm5vQ2FzZSIsInJmZGMiLCJzYWZlU3RyaW5naWZ5Iiwic2Vuc2l0aXZlRmllbGRzIiwic3RhcnRUaW1lIiwiU3ltYm9sIiwiZm9yIiwicGlub0h0dHBTdGFydFRpbWUiLCJkaXNhYmxlQm9keVBhcnNpbmdTeW1ib2wiLCJkaXNhYmxlRmlsZVBhcnNpbmdTeW1ib2wiLCJoYXNoTWFwSWRzIiwiX2lkIiwiaWQiLCJyZWdleElkIiwibWFza0FycmF5Iiwib2JqIiwib3B0aW9ucyIsImFyciIsImVudHJpZXMiLCJpIiwiZWxlbWVudCIsIm1hc2tTcGVjaWFsVHlwZXMiLCJPYmplY3QiLCJhc3NpZ24iLCJtYXNrQnVmZmVycyIsIm1hc2tTdHJlYW1zIiwiY2hlY2tPYmplY3RJZCIsIkFycmF5IiwiaXNBcnJheSIsImlzVmFsaWQiLCJ0b1N0cmluZyIsInR5cGUiLCJieXRlTGVuZ3RoIiwibWFza2VkIiwia2V5IiwicGljayIsIm9iamVjdCIsImtleXMiLCJyZWR1Y2UiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpc051bGwiLCJ2YWwiLCJpc1VuZGVmaW5lZCIsImlzT2JqZWN0IiwiaXNTdHJpbmciLCJpc0NyZWRpdENhcmQiLCJkaWdpdHMiLCJyZXBsYWNlIiwidHlwZXMiLCJsZW5ndGgiLCJtYXRjaCIsImxlbmd0aHMiLCJsIiwibGVuIiwiTnVtYmVyIiwiaXNGaW5pdGUiLCJpc0lEIiwiY2hlY2tDdWlkIiwiaW5kZXhPZiIsImNoZWNrVVVJRCIsImFueU5vbk5pbCIsIm1hc2tTdHJpbmciLCJwcm9wcyIsImlzS2V5U3RyaW5nIiwiaXNIZWFkZXJzIiwibWFwIiwicHJvcCIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJwdXNoIiwibm90SW5jbHVkZWRJblByb3BzIiwiY2hlY2tJZCIsInNuYWtlQ2FzZSIsInRlc3QiLCJtYXNrQ3JlZGl0Q2FyZHMiLCJzcGxpdCIsInNsaWNlIiwiaGVhZGVyc1RvTG93ZXJDYXNlIiwiaGVhZGVycyIsImxvd2VyQ2FzZWRIZWFkZXJzIiwiaGVhZGVyIiwibWFza1Byb3BzIiwicGFyc2VSZXF1ZXN0IiwiY29uZmlnIiwic3RhcnQiLCJyZXEiLCJjdHgiLCJyZXNwb25zZUhlYWRlcnMiLCJ1c2VyRmllbGRzIiwic2FuaXRpemVGaWVsZHMiLCJzYW5pdGl6ZUhlYWRlcnMiLCJwcm90byIsImNpcmNsZXMiLCJwYXJzZUJvZHkiLCJwYXJzZUZpbGVzIiwiY2xvbmUiLCJFcnJvciIsIm5vZGVSZXEiLCJtYXNrUHJvcHNPcHRpb25zIiwibWFza1NwZWNpYWxUeXBlc09wdGlvbnMiLCJyZXF1ZXN0SGVhZGVycyIsIm1ldGhvZCIsIm9yaWdpbmFsVXJsIiwidXJsIiwicXVlcnkiLCJhYnNvbHV0ZVVybCIsInFzIiwicGFyc2UiLCJwYXRoIiwib3JpZ2luIiwicGF0aG5hbWUiLCJzdHJpbmdpZnkiLCJ1c2VyIiwicGFyc2VkVXNlciIsInN0YXRlIiwidG9KU09OIiwidG9PYmplY3QiLCJlcnIiLCJKU09OIiwiaXAiLCJpcF9hZGRyZXNzIiwiYm9keSIsIm9yaWdpbmFsQm9keSIsInJlcXVlc3QiLCJfb3JpZ2luYWxCb2R5IiwiY29va2llcyIsInJlc3VsdCIsInRpbWVzdGFtcCIsImdldFRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwiRGF0ZSIsIl9zdGFydFRpbWUiLCJyZXNwb25zZSIsInBhcnNlZEhlYWRlcnMiLCJ2ZXJzaW9uIiwibWFqb3IiLCJtaW5vciIsImh0dHBfdmVyc2lvbiIsInN0YXR1c0NvZGUiLCJzdGF0dXNfY29kZSIsInN0YXR1c01lc3NhZ2UiLCJyZWFzb25fcGhyYXNlIiwiZGF0ZSIsImR1cmF0aW9uIiwicmVxdWVzdElkIiwicmVxSWQiLCJodHRwVmVyc2lvbiIsImh0dHBWZXJzaW9uTWFqb3IiLCJodHRwVmVyc2lvbk1pbm9yIiwiZmlsZSIsImZpbGVzIiwibWlsbGlzZWNvbmRzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsSUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsZUFBRCxDQUF4Qjs7QUFDQSxJQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxXQUFELENBQW5COztBQUNBLElBQU1FLGFBQWEsR0FBR0YsT0FBTyxDQUFDLGdCQUFELENBQTdCOztBQUNBLElBQU1HLE1BQU0sR0FBR0gsT0FBTyxDQUFDLFFBQUQsQ0FBdEI7O0FBQ0EsSUFBTUksY0FBYyxHQUFHSixPQUFPLENBQUMsa0JBQUQsQ0FBOUI7O0FBQ0EsSUFBTUssS0FBSyxHQUFHTCxPQUFPLENBQUMsT0FBRCxDQUFQLENBQWlCLGVBQWpCLENBQWQ7O0FBQ0EsSUFBTU0sTUFBTSxHQUFHTixPQUFPLENBQUMsd0JBQUQsQ0FBdEI7O0FBQ0EsSUFBTU8sV0FBVyxHQUFHUCxPQUFPLENBQUMsY0FBRCxDQUEzQjs7QUFDQSxJQUFNUSxhQUFhLEdBQUdSLE9BQU8sQ0FBQyxpQkFBRCxDQUE3Qjs7QUFDQSxJQUFNUyxRQUFRLEdBQUdULE9BQU8sQ0FBQyxXQUFELENBQXhCOztBQUNBLElBQU1VLFFBQVEsR0FBR1YsT0FBTyxDQUFDLFdBQUQsQ0FBeEI7O0FBQ0EsSUFBTVcsTUFBTSxHQUFHWCxPQUFPLENBQUMsU0FBRCxDQUF0Qjs7QUFDQSxJQUFNWSxFQUFFLEdBQUdaLE9BQU8sQ0FBQyxJQUFELENBQWxCOztBQUNBLElBQU1hLE1BQU0sR0FBR2IsT0FBTyxDQUFDLFNBQUQsQ0FBdEI7O0FBQ0EsSUFBTWMsSUFBSSxHQUFHZCxPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFDQSxJQUFNZSxhQUFhLEdBQUdmLE9BQU8sQ0FBQyxxQkFBRCxDQUE3Qjs7QUFDQSxJQUFNZ0Is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QUFPbEQsdUJBQVAsQ0FBakIsQ0FENEIsQ0FBbkM7QUFHRixRQUFJLFFBQU9tRCxLQUFQLE1BQWlCLFFBQXJCLEVBQ0V4QixNQUFNLENBQUNILE9BQVAsQ0FBZTJCLEtBQWYsR0FBdUJ0SixhQUFhLENBQ2xDK0YsS0FBSyxDQUFDNUUsZ0JBQWdCLENBQUNtSSxLQUFELEVBQVFuRCx1QkFBUixDQUFqQixDQUQ2QixDQUFwQztBQUdIOztBQUVEMkIsRUFBQUEsTUFBTSxDQUFDaUIsUUFBUCxHQUFrQjVKLGFBQWEsQ0FBQ0ksTUFBTSxDQUFDNkYsS0FBRCxDQUFQLENBQWIsQ0FBNkJtRSxZQUEvQztBQUVBLFNBQU96QixNQUFQO0FBQ0QsQ0FyV0Q7O0FBdVdBMEIsTUFBTSxDQUFDQyxPQUFQLEdBQWlCdkUsWUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBPYmplY3RJZCA9IHJlcXVpcmUoJ2Jzb24tb2JqZWN0aWQnKTtcbmNvbnN0IFVybCA9IHJlcXVpcmUoJ3VybC1wYXJzZScpO1xuY29uc3QgY29udmVydEhydGltZSA9IHJlcXVpcmUoJ2NvbnZlcnQtaHJ0aW1lJyk7XG5jb25zdCBjb29raWUgPSByZXF1aXJlKCdjb29raWUnKTtcbmNvbnN0IGNyZWRpdENhcmRUeXBlID0gcmVxdWlyZSgnY3JlZGl0LWNhcmQtdHlwZScpO1xuY29uc3QgZGVidWcgPSByZXF1aXJlKCdkZWJ1ZycpKCdwYXJzZS1yZXF1ZXN0Jyk7XG5jb25zdCBocnRpbWUgPSByZXF1aXJlKCdicm93c2VyLXByb2Nlc3MtaHJ0aW1lJyk7XG5jb25zdCBodHRwSGVhZGVycyA9IHJlcXVpcmUoJ2h0dHAtaGVhZGVycycpO1xuY29uc3QgaXNBcnJheUJ1ZmZlciA9IHJlcXVpcmUoJ2lzLWFycmF5LWJ1ZmZlcicpO1xuY29uc3QgaXNCdWZmZXIgPSByZXF1aXJlKCdpcy1idWZmZXInKTtcbmNvbnN0IGlzU3RyZWFtID0gcmVxdWlyZSgnaXMtc3RyZWFtJyk7XG5jb25zdCBpc1VVSUQgPSByZXF1aXJlKCdpcy11dWlkJyk7XG5jb25zdCBtcyA9IHJlcXVpcmUoJ21zJyk7XG5jb25zdCBub0Nhc2UgPSByZXF1aXJlKCduby1jYXNlJyk7XG5jb25zdCByZmRjID0gcmVxdWlyZSgncmZkYycpO1xuY29uc3Qgc2FmZVN0cmluZ2lmeSA9IHJlcXVpcmUoJ2Zhc3Qtc2FmZS1zdHJpbmdpZnknKTtcbmNvbnN0IHNlbnNpdGl2ZUZpZWxkcyA9IHJlcXVpcmUoJ3NlbnNpdGl2ZS1maWVsZHMnKTtcblxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2NhYmluanMvcmVxdWVzdC1yZWNlaXZlZFxuY29uc3Qgc3RhcnRUaW1lID0gU3ltYm9sLmZvcigncmVxdWVzdC1yZWNlaXZlZC5zdGFydFRpbWUnKTtcbmNvbnN0IHBpbm9IdHRwU3RhcnRUaW1lID0gU3ltYm9sLmZvcigncGluby1odHRwLnN0YXJ0VGltZScpO1xuXG5jb25zdCBkaXNhYmxlQm9keVBhcnNpbmdTeW1ib2wgPSBTeW1ib2wuZm9yKCdwYXJzZS1yZXF1ZXN0LmRpc2FibGVCb2R5UGFyc2luZycpO1xuY29uc3QgZGlzYWJsZUZpbGVQYXJzaW5nU3ltYm9sID0gU3ltYm9sLmZvcigncGFyc2UtcmVxdWVzdC5kaXNhYmxlRmlsZVBhcnNpbmcnKTtcblxuY29uc3QgaGFzaE1hcElkcyA9IHtcbiAgX2lkOiB0cnVlLFxuICBpZDogdHJ1ZVxufTtcblxuY29uc3QgcmVnZXhJZCA9IC9faWQkLztcblxuZnVuY3Rpb24gbWFza0FycmF5KG9iaiwgb3B0aW9ucykge1xuICBjb25zdCBhcnIgPSBbXTtcbiAgZm9yIChjb25zdCBbaSwgZWxlbWVudF0gb2Ygb2JqLmVudHJpZXMoKSkge1xuICAgIGFycltpXSA9IG1hc2tTcGVjaWFsVHlwZXMoZWxlbWVudCwgb3B0aW9ucyk7XG4gIH1cblxuICByZXR1cm4gYXJyO1xufVxuXG5mdW5jdGlvbiBtYXNrU3BlY2lhbFR5cGVzKG9iaiwgb3B0aW9ucykge1xuICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbihcbiAgICB7XG4gICAgICBtYXNrQnVmZmVyczogdHJ1ZSxcbiAgICAgIG1hc2tTdHJlYW1zOiB0cnVlLFxuICAgICAgY2hlY2tPYmplY3RJZDogdHJ1ZVxuICAgIH0sXG4gICAgb3B0aW9uc1xuICApO1xuICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcpIHJldHVybiBvYmo7XG5cbiAgLy8gd2UgbmVlZCB0byByZXR1cm4gYW4gYXJyYXkgaWYgcGFzc2VkIGFuIGFycmF5XG4gIGlmIChBcnJheS5pc0FycmF5KG9iaikpIHJldHVybiBtYXNrQXJyYXkob2JqLCBvcHRpb25zKTtcblxuICAvLyBpZiBpdCB3YXMgYSBic29uIG9iamVjdGlkIHJldHVybiBlYXJseVxuICBpZiAob3B0aW9ucy5jaGVja09iamVjdElkICYmIE9iamVjdElkLmlzVmFsaWQob2JqKSkgcmV0dXJuIG9iai50b1N0cmluZygpO1xuXG4gIC8vIGNoZWNrIGlmIGl0IHdhcyBhIHN0cmVhbVxuICBpZiAob3B0aW9ucy5tYXNrU3RyZWFtcyAmJiBpc1N0cmVhbShvYmopKSByZXR1cm4geyB0eXBlOiAnU3RyZWFtJyB9O1xuXG4gIC8vIGNoZWNrIGlmIGl0IHdhcyBhIGJ1ZmZlciBvciBhcnJheSBidWZmZXJcbiAgLy8gYmVmb3JlIGl0ZXJhdGluZyBvdmVyIHRoZSBvYmplY3QncyBrZXlzXG4gIGlmIChvcHRpb25zLm1hc2tCdWZmZXJzKSB7XG4gICAgaWYgKGlzQnVmZmVyKG9iaikpXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnQnVmZmVyJyxcbiAgICAgICAgYnl0ZUxlbmd0aDogb2JqLmJ5dGVMZW5ndGhcbiAgICAgIH07XG5cbiAgICBpZiAoaXNBcnJheUJ1ZmZlcihvYmopKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ0FycmF5QnVmZmVyJyxcbiAgICAgICAgYnl0ZUxlbmd0aDogb2JqLmJ5dGVMZW5ndGhcbiAgICAgIH07XG4gIH1cblxuICAvLyB3ZSBuZWVkIHRvIHJldHVybiBhbiBvYmplY3QgaWYgcGFzc2VkIGFuIG9iamVjdFxuICBjb25zdCBtYXNrZWQgPSB7fTtcbiAgLy8gZm9yLi4uaW4gaXMgbXVjaCBmYXN0ZXIgdGhhbiBPYmplY3QuZW50cmllcyBvciBhbnkgYWx0ZXJuYXRpdmVcbiAgLy8gVE9ETzogd2Ugc2hvdWxkIG9wdGltaXplIHRoaXMgZnVydGhlciBpbiB0aGUgZnV0dXJlXG4gIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgIGlmICh0eXBlb2Ygb2JqW2tleV0gPT09ICdvYmplY3QnKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShvYmpba2V5XSkpIHtcbiAgICAgICAgbWFza2VkW2tleV0gPSBtYXNrU3BlY2lhbFR5cGVzKG9ialtrZXldLCBvcHRpb25zKTtcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5tYXNrU3RyZWFtcyAmJiBpc1N0cmVhbShvYmpba2V5XSkpIHtcbiAgICAgICAgbWFza2VkW2tleV0gPSB7IHR5cGU6ICdTdHJlYW0nIH07XG4gICAgICB9IGVsc2UgaWYgKG9wdGlvbnMubWFza0J1ZmZlcnMgJiYgaXNCdWZmZXIob2JqW2tleV0pKSB7XG4gICAgICAgIG1hc2tlZFtrZXldID0ge1xuICAgICAgICAgIHR5cGU6ICdCdWZmZXInLFxuICAgICAgICAgIGJ5dGVMZW5ndGg6IG9ialtrZXldLmJ5dGVMZW5ndGhcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5tYXNrQnVmZmVycyAmJiBpc0FycmF5QnVmZmVyKG9ialtrZXldKSkge1xuICAgICAgICBtYXNrZWRba2V5XSA9IHtcbiAgICAgICAgICB0eXBlOiAnQXJyYXlCdWZmZXInLFxuICAgICAgICAgIGJ5dGVMZW5ndGg6IG9ialtrZXldLmJ5dGVMZW5ndGhcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1hc2tlZFtrZXldID0gbWFza1NwZWNpYWxUeXBlcyhvYmpba2V5XSwgb3B0aW9ucyk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIG1hc2tlZFtrZXldID0gb2JqW2tleV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG1hc2tlZDtcbn1cblxuZnVuY3Rpb24gcGljayhvYmplY3QsIGtleXMpIHtcbiAgcmV0dXJuIGtleXMucmVkdWNlKChvYmosIGtleSkgPT4ge1xuICAgIGlmIChvYmplY3QgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwga2V5KSkge1xuICAgICAgb2JqW2tleV0gPSBvYmplY3Rba2V5XTtcbiAgICB9XG5cbiAgICByZXR1cm4gb2JqO1xuICB9LCB7fSk7XG59XG5cbmZ1bmN0aW9uIGlzTnVsbCh2YWwpIHtcbiAgcmV0dXJuIHZhbCA9PT0gbnVsbDtcbn1cblxuZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAndW5kZWZpbmVkJztcbn1cblxuZnVuY3Rpb24gaXNPYmplY3QodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnb2JqZWN0JyAmJiB2YWwgIT09IG51bGwgJiYgIUFycmF5LmlzQXJyYXkodmFsKTtcbn1cblxuZnVuY3Rpb24gaXNTdHJpbmcodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJztcbn1cblxuLy8gPGh0dHBzOi8vZ2l0aHViLmNvbS9icmFpbnRyZWUvY3JlZGl0LWNhcmQtdHlwZS9pc3N1ZXMvOTA+XG5mdW5jdGlvbiBpc0NyZWRpdENhcmQodmFsKSB7XG4gIGNvbnN0IGRpZ2l0cyA9IHZhbC5yZXBsYWNlKC9cXEQvZywgJycpO1xuICBjb25zdCB0eXBlcyA9IGNyZWRpdENhcmRUeXBlKGRpZ2l0cyk7XG4gIGlmICghQXJyYXkuaXNBcnJheSh0eXBlcykgfHwgdHlwZXMubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG4gIGxldCBtYXRjaCA9IGZhbHNlO1xuICBmb3IgKGNvbnN0IHR5cGUgb2YgdHlwZXMpIHtcbiAgICBpZiAobWF0Y2gpIGJyZWFrO1xuICAgIC8vIGNhbiBtYXRjaCBhbnkgb25lIG9mIHRoZSBsZW5ndGhzXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHR5cGUubGVuZ3RocykgfHwgdHlwZS5sZW5ndGhzLmxlbmd0aCA9PT0gMCkgY29udGludWU7XG4gICAgZm9yIChsZXQgbCA9IDA7IGwgPCB0eXBlLmxlbmd0aHMubGVuZ3RoOyBsKyspIHtcbiAgICAgIGNvbnN0IGxlbiA9IHR5cGUubGVuZ3Roc1tsXTtcbiAgICAgIGlmIChOdW1iZXIuaXNGaW5pdGUobGVuKSAmJiBsZW4gPT09IGRpZ2l0cy5sZW5ndGgpIHtcbiAgICAgICAgbWF0Y2ggPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWF0Y2g7XG59XG5cbmZ1bmN0aW9uIGlzSUQodmFsLCBvcHRpb25zKSB7XG4gIC8vIGlmIGl0IHdhcyBhbiBvYmplY3RpZCByZXR1cm4gZWFybHlcbiAgaWYgKG9wdGlvbnMuY2hlY2tPYmplY3RJZCAmJiBPYmplY3RJZC5pc1ZhbGlkKHZhbCkpIHJldHVybiB0cnVlO1xuXG4gIC8vIGlmIGl0IHdhcyBhIGN1aWQgcmV0dXJuIGVhcmx5XG4gIC8vIDxodHRwczovL2dpdGh1Yi5jb20vZXJpY2VsbGlvdHQvY3VpZC9pc3N1ZXMvODgjaXNzdWVjb21tZW50LTMzOTg0ODkyMj5cbiAgaWYgKG9wdGlvbnMuY2hlY2tDdWlkICYmIHZhbC5pbmRleE9mKCdjJykgPT09IDAgJiYgdmFsLmxlbmd0aCA+PSA3KVxuICAgIHJldHVybiB0cnVlO1xuXG4gIC8vIGlmIGl0IHdhcyBhIHV1aWQgdjEtNSByZXR1cm4gZWFybHlcbiAgaWYgKG9wdGlvbnMuY2hlY2tVVUlEICYmIGlzVVVJRC5hbnlOb25OaWwodmFsKSkgcmV0dXJuIHRydWU7XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBtYXNrU3RyaW5nKGtleSwgdmFsLCBwcm9wcywgb3B0aW9ucykge1xuICBjb25zdCBpc0tleVN0cmluZyA9IGlzU3RyaW5nKGtleSk7XG5cbiAgaWYgKG9wdGlvbnMuaXNIZWFkZXJzKSB7XG4gICAgLy8gaGVhZGVycyBhcmUgY2FzZS1pbnNlbnNpdGl2ZVxuICAgIHByb3BzID0gcHJvcHMubWFwKHByb3AgPT4gcHJvcC50b0xvd2VyQ2FzZSgpKTtcbiAgICBpZiAocHJvcHMuaW5jbHVkZXMoJ3JlZmVyZXInKSB8fCBwcm9wcy5pbmNsdWRlcygncmVmZXJyZXInKSkge1xuICAgICAgaWYgKCFwcm9wcy5pbmNsdWRlcygncmVmZXJlcicpKSBwcm9wcy5wdXNoKCdyZWZlcmVyJyk7XG4gICAgICBpZiAoIXByb3BzLmluY2x1ZGVzKCdyZWZlcnJlcicpKSBwcm9wcy5wdXNoKCdyZWZlcnJlcicpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG5vdEluY2x1ZGVkSW5Qcm9wcyA9ICFpc0tleVN0cmluZyB8fCAhcHJvcHMuaW5jbHVkZXMoa2V5KTtcblxuICBpZiAoIW9wdGlvbnMuaXNIZWFkZXJzKSB7XG4gICAgLy8gY2hlY2sgaWYgaXQgY2xvc2VseSByZXNlbWJsZXMgYSBwcmltYXJ5IElEIGFuZCByZXR1cm4gZWFybHkgaWYgc29cbiAgICBpZiAoaXNLZXlTdHJpbmcgJiYgb3B0aW9ucy5jaGVja0lkKSB7XG4gICAgICAvLyBfaWRcbiAgICAgIC8vIGlkXG4gICAgICAvLyBJRFxuICAgICAgLy8gSWRcbiAgICAgIGlmIChoYXNoTWFwSWRzW2tleS50b0xvd2VyQ2FzZSgpXSkgcmV0dXJuIHZhbDtcbiAgICAgIC8vIHByb2R1Y3RfaWRcbiAgICAgIC8vIHByb2R1Y3QtaWRcbiAgICAgIC8vIHByb2R1Y3RbaWRdXG4gICAgICAvLyBwcm9kdWN0SWRcbiAgICAgIC8vIHByb2R1Y3RJRFxuICAgICAgY29uc3Qgc25ha2VDYXNlID0gbm9DYXNlKGtleSwgbnVsbCwgJ18nKTtcbiAgICAgIGlmIChyZWdleElkLnRlc3Qoc25ha2VDYXNlKSkgcmV0dXJuIHZhbDtcbiAgICB9XG5cbiAgICAvLyBpZiBpdCB3YXMgYW4gb2JqZWN0aWQsIGN1aWQsIG9yIHV1aWQgcmV0dXJuIGVhcmx5XG4gICAgaWYgKGlzSUQodmFsLCBvcHRpb25zKSAmJiBub3RJbmNsdWRlZEluUHJvcHMpIHJldHVybiB2YWw7XG5cbiAgICAvLyBpZiBpdCB3YXMgYSBjcmVkaXQgY2FyZCB0aGVuIHJlcGxhY2UgYWxsIGRpZ2l0cyB3aXRoIGFzdGVyaXNrXG4gICAgaWYgKG9wdGlvbnMubWFza0NyZWRpdENhcmRzICYmIGlzQ3JlZGl0Q2FyZCh2YWwpKVxuICAgICAgcmV0dXJuIHZhbC5yZXBsYWNlKC9bXlxcRFxcc10vZywgJyonKTtcbiAgfVxuXG4gIGlmIChub3RJbmNsdWRlZEluUHJvcHMpIHJldHVybiB2YWw7XG5cbiAgLy8gcmVwbGFjZSBvbmx5IHRoZSBhdXRoZW50aWNhdGlvbiA8Y3JlZGVudGlhbHM+IHBvcnRpb24gd2l0aCBhc3Rlcmlza1xuICAvLyBBdXRob3JpemF0aW9uOiA8dHlwZT4gPGNyZWRlbnRpYWxzPlxuICBpZiAob3B0aW9ucy5pc0hlYWRlcnMgJiYga2V5ID09PSAnYXV0aG9yaXphdGlvbicpXG4gICAgcmV0dXJuIGAke3ZhbC5zcGxpdCgnICcpWzBdfSAke3ZhbFxuICAgICAgLnNsaWNlKHZhbC5pbmRleE9mKCcgJykgKyAxKVxuICAgICAgLnJlcGxhY2UoLy4vZywgJyonKX1gO1xuICByZXR1cm4gdmFsLnJlcGxhY2UoLy4vZywgJyonKTtcbn1cblxuZnVuY3Rpb24gaGVhZGVyc1RvTG93ZXJDYXNlKGhlYWRlcnMpIHtcbiAgaWYgKHR5cGVvZiBoZWFkZXJzICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KGhlYWRlcnMpKSByZXR1cm4gaGVhZGVycztcbiAgY29uc3QgbG93ZXJDYXNlZEhlYWRlcnMgPSB7fTtcbiAgZm9yIChjb25zdCBoZWFkZXIgaW4gaGVhZGVycykge1xuICAgIGlmIChpc1N0cmluZyhoZWFkZXJzW2hlYWRlcl0pKVxuICAgICAgbG93ZXJDYXNlZEhlYWRlcnNbaGVhZGVyLnRvTG93ZXJDYXNlKCldID0gaGVhZGVyc1toZWFkZXJdO1xuICB9XG5cbiAgcmV0dXJuIGxvd2VyQ2FzZWRIZWFkZXJzO1xufVxuXG5mdW5jdGlvbiBtYXNrUHJvcHMob2JqLCBwcm9wcywgb3B0aW9ucykge1xuICBvcHRpb25zID0gT2JqZWN0LmFzc2lnbihcbiAgICB7XG4gICAgICBtYXNrQ3JlZGl0Q2FyZHM6IHRydWUsXG4gICAgICBpc0hlYWRlcnM6IGZhbHNlLFxuICAgICAgY2hlY2tJZDogdHJ1ZSxcbiAgICAgIGNoZWNrQ3VpZDogdHJ1ZSxcbiAgICAgIGNoZWNrT2JqZWN0SWQ6IHRydWUsXG4gICAgICBjaGVja1VVSUQ6IHRydWVcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICBpZiAoaXNTdHJpbmcob2JqKSkgcmV0dXJuIG1hc2tTdHJpbmcobnVsbCwgb2JqLCBwcm9wcywgb3B0aW9ucyk7XG5cbiAgLy8gZm9yLi4uaW4gaXMgbXVjaCBmYXN0ZXIgdGhhbiBPYmplY3QuZW50cmllcyBvciBhbnkgYWx0ZXJuYXRpdmVcbiAgZm9yIChjb25zdCBrZXkgaW4gb2JqKSB7XG4gICAgaWYgKHR5cGVvZiBvYmpba2V5XSA9PT0gJ29iamVjdCcpXG4gICAgICBvYmpba2V5XSA9IG1hc2tQcm9wcyhvYmpba2V5XSwgcHJvcHMsIG9wdGlvbnMpO1xuICAgIGVsc2UgaWYgKGlzU3RyaW5nKG9ialtrZXldKSlcbiAgICAgIG9ialtrZXldID0gbWFza1N0cmluZyhrZXksIG9ialtrZXldLCBwcm9wcywgb3B0aW9ucyk7XG4gIH1cblxuICByZXR1cm4gb2JqO1xufVxuXG4vLyBpbnNwaXJlZCBieSByYXZlbidzIHBhcnNlUmVxdWVzdFxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHlcbmNvbnN0IHBhcnNlUmVxdWVzdCA9IChjb25maWcgPSB7fSkgPT4ge1xuICBjb25zdCBzdGFydCA9IGhydGltZSgpO1xuICBjb25zdCBpZCA9IG5ldyBPYmplY3RJZCgpO1xuXG4gIGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oXG4gICAge1xuICAgICAgcmVxOiBmYWxzZSxcbiAgICAgIGN0eDogZmFsc2UsXG4gICAgICByZXNwb25zZUhlYWRlcnM6ICcnLFxuICAgICAgdXNlckZpZWxkczogWydpZCcsICdlbWFpbCcsICdmdWxsX25hbWUnLCAnaXBfYWRkcmVzcyddLFxuICAgICAgc2FuaXRpemVGaWVsZHM6IHNlbnNpdGl2ZUZpZWxkcyxcbiAgICAgIHNhbml0aXplSGVhZGVyczogWydhdXRob3JpemF0aW9uJ10sXG4gICAgICBtYXNrQ3JlZGl0Q2FyZHM6IHRydWUsXG4gICAgICBtYXNrQnVmZmVyczogdHJ1ZSxcbiAgICAgIG1hc2tTdHJlYW1zOiB0cnVlLFxuICAgICAgY2hlY2tJZDogdHJ1ZSxcbiAgICAgIGNoZWNrQ3VpZDogdHJ1ZSxcbiAgICAgIGNoZWNrT2JqZWN0SWQ6IHRydWUsXG4gICAgICBjaGVja1VVSUQ6IHRydWUsXG4gICAgICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL2RhdmlkbWFya2NsZW1lbnRzL3JmZGM+XG4gICAgICByZmRjOiB7XG4gICAgICAgIHByb3RvOiBmYWxzZSxcbiAgICAgICAgY2lyY2xlczogZmFsc2VcbiAgICAgIH0sXG4gICAgICBwYXJzZUJvZHk6IHRydWUsXG4gICAgICBwYXJzZUZpbGVzOiB0cnVlXG4gICAgfSxcbiAgICBjb25maWdcbiAgKTtcblxuICBjb25zdCBjbG9uZSA9IHJmZGMoY29uZmlnLnJmZGMpO1xuXG4gIGNvbnN0IHtcbiAgICByZXEsXG4gICAgY3R4LFxuICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICB1c2VyRmllbGRzLFxuICAgIHNhbml0aXplRmllbGRzLFxuICAgIHNhbml0aXplSGVhZGVycyxcbiAgICBtYXNrQ3JlZGl0Q2FyZHMsXG4gICAgbWFza0J1ZmZlcnMsXG4gICAgbWFza1N0cmVhbXMsXG4gICAgY2hlY2tJZCxcbiAgICBjaGVja0N1aWQsXG4gICAgY2hlY2tPYmplY3RJZCxcbiAgICBjaGVja1VVSUQsXG4gICAgcGFyc2VCb2R5LFxuICAgIHBhcnNlRmlsZXNcbiAgfSA9IGNvbmZpZztcblxuICAvLyBkbyBub3QgYWxsb3cgYm90aCBgcmVxYCBhbmQgYGN0eGAgdG8gYmUgc3BlY2lmaWVkXG4gIGlmIChyZXEgJiYgY3R4KVxuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdZb3UgbXVzdCBlaXRoZXIgdXNlIGByZXFgIChFeHByZXNzL0Nvbm5lY3QpIG9yIGBjdHhgIChLb2EpIG9wdGlvbiwgYnV0IG5vdCBib3RoJ1xuICAgICk7XG5cbiAgY29uc3Qgbm9kZVJlcSA9IGN0eCA/IGN0eC5yZXEgOiByZXEgPyByZXEgOiB7fTtcblxuICBjb25zdCBtYXNrUHJvcHNPcHRpb25zID0ge1xuICAgIG1hc2tDcmVkaXRDYXJkcyxcbiAgICBjaGVja0lkLFxuICAgIGNoZWNrQ3VpZCxcbiAgICBjaGVja09iamVjdElkLFxuICAgIGNoZWNrVVVJRFxuICB9O1xuXG4gIGNvbnN0IG1hc2tTcGVjaWFsVHlwZXNPcHRpb25zID0ge1xuICAgIG1hc2tCdWZmZXJzLFxuICAgIG1hc2tTdHJlYW1zLFxuICAgIGNoZWNrT2JqZWN0SWRcbiAgfTtcblxuICBjb25zdCByZXF1ZXN0SGVhZGVycyA9IG5vZGVSZXEuaGVhZGVycztcbiAgbGV0IGhlYWRlcnM7XG5cbiAgaWYgKHJlcXVlc3RIZWFkZXJzKVxuICAgIGhlYWRlcnMgPSBtYXNrUHJvcHMoaGVhZGVyc1RvTG93ZXJDYXNlKHJlcXVlc3RIZWFkZXJzKSwgc2FuaXRpemVIZWFkZXJzLCB7XG4gICAgICBpc0hlYWRlcnM6IHRydWVcbiAgICB9KTtcblxuICBsZXQgbWV0aG9kO1xuICBpZiAoY3R4KSBtZXRob2QgPSBjdHgubWV0aG9kO1xuICBlbHNlIGlmIChyZXEpIG1ldGhvZCA9IHJlcS5tZXRob2Q7XG5cbiAgLy8gaW5zcGlyZWQgZnJvbSBgcHJlc2VydmUtcXNgIHBhY2thZ2VcbiAgbGV0IG9yaWdpbmFsVXJsO1xuICBpZiAoY3R4KSBvcmlnaW5hbFVybCA9IGN0eC5vcmlnaW5hbFVybCB8fCBjdHgudXJsO1xuICBlbHNlIGlmIChyZXEpIG9yaWdpbmFsVXJsID0gcmVxLm9yaWdpbmFsVXJsIHx8IHJlcS51cmw7XG5cbiAgbGV0IHF1ZXJ5O1xuICBsZXQgYWJzb2x1dGVVcmw7XG4gIGlmIChvcmlnaW5hbFVybCkge1xuICAgIG9yaWdpbmFsVXJsID0gbmV3IFVybChvcmlnaW5hbFVybCwge30pO1xuXG4gICAgLy8gcGFyc2UgcXVlcnksIHBhdGgsIGFuZCBvcmlnaW4gdG8gcHJlcGFyZSBhYnNvbHV0ZSBVcmxcbiAgICBxdWVyeSA9IFVybC5xcy5wYXJzZShvcmlnaW5hbFVybC5xdWVyeSk7XG4gICAgY29uc3QgcGF0aCA9XG4gICAgICBvcmlnaW5hbFVybC5vcmlnaW4gPT09ICdudWxsJ1xuICAgICAgICA/IG9yaWdpbmFsVXJsLnBhdGhuYW1lXG4gICAgICAgIDogYCR7b3JpZ2luYWxVcmwub3JpZ2lufSR7b3JpZ2luYWxVcmwucGF0aG5hbWV9YDtcbiAgICBjb25zdCBxcyA9IFVybC5xcy5zdHJpbmdpZnkocXVlcnksIHRydWUpO1xuICAgIGFic29sdXRlVXJsID0gcGF0aCArIHFzO1xuICB9XG5cbiAgLy8gZGVmYXVsdCB0byB0aGUgdXNlciBvYmplY3RcbiAgbGV0IHVzZXIgPSB7fTtcblxuICBsZXQgcGFyc2VkVXNlcjtcbiAgaWYgKGN0eCAmJiBpc09iamVjdChjdHguc3RhdGUudXNlcikpIHBhcnNlZFVzZXIgPSBjdHguc3RhdGUudXNlcjtcbiAgZWxzZSBpZiAocmVxICYmIGlzT2JqZWN0KHJlcS51c2VyKSkgcGFyc2VkVXNlciA9IHJlcS51c2VyO1xuXG4gIGlmIChwYXJzZWRVc2VyKSB7XG4gICAgdHJ5IHtcbiAgICAgIHVzZXIgPVxuICAgICAgICB0eXBlb2YgcGFyc2VkVXNlci50b0pTT04gPT09ICdmdW5jdGlvbidcbiAgICAgICAgICA/IHBhcnNlZFVzZXIudG9KU09OKClcbiAgICAgICAgICA6IHR5cGVvZiBwYXJzZWRVc2VyLnRvT2JqZWN0ID09PSAnZnVuY3Rpb24nXG4gICAgICAgICAgPyBwYXJzZWRVc2VyLnRvT2JqZWN0KClcbiAgICAgICAgICA6IGNsb25lKHBhcnNlZFVzZXIpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgZGVidWcoZXJyKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIHVzZXIgPSBKU09OLnBhcnNlKHNhZmVTdHJpbmdpZnkocGFyc2VkVXNlcikpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGRlYnVnKGVycik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY29uc3QgaXAgPSBjdHggPyBjdHguaXAgOiByZXEgPyByZXEuaXAgOiBudWxsO1xuXG4gIGlmIChpcCAmJiAhaXNTdHJpbmcodXNlci5pcF9hZGRyZXNzKSkgdXNlci5pcF9hZGRyZXNzID0gaXA7XG5cbiAgaWYgKHVzZXIgJiYgQXJyYXkuaXNBcnJheSh1c2VyRmllbGRzKSAmJiB1c2VyRmllbGRzLmxlbmd0aCA+IDApXG4gICAgdXNlciA9IHBpY2sodXNlciwgdXNlckZpZWxkcyk7XG5cbiAgLy8gcmVjdXJzaXZlbHkgc2VhcmNoIHRocm91Z2ggdXNlciBhbmQgZmlsdGVyIG91dCBwYXNzd29yZHMgZnJvbSBpdFxuICBpZiAodXNlcikgdXNlciA9IG1hc2tQcm9wcyh1c2VyLCBzYW5pdGl6ZUZpZWxkcywgbWFza1Byb3BzT3B0aW9ucyk7XG5cbiAgbGV0IGJvZHk7XG4gIGNvbnN0IG9yaWdpbmFsQm9keSA9IGN0eFxuICAgID8gY3R4LnJlcXVlc3QuX29yaWdpbmFsQm9keSB8fCBjdHgucmVxdWVzdC5ib2R5XG4gICAgOiByZXFcbiAgICA/IHJlcS5fb3JpZ2luYWxCb2R5IHx8IHJlcS5ib2R5XG4gICAgOiBudWxsO1xuXG4gIGlmIChvcmlnaW5hbEJvZHkgJiYgcGFyc2VCb2R5ICYmICFub2RlUmVxW2Rpc2FibGVCb2R5UGFyc2luZ1N5bWJvbF0pIHtcbiAgICAvL1xuICAgIC8vIHJlY3Vyc2l2ZWx5IHNlYXJjaCB0aHJvdWdoIGJvZHkgYW5kIGZpbHRlciBvdXQgcGFzc3dvcmRzIGZyb20gaXRcbiAgICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL25pZnR5bGV0dHVjZS9mcmlzYmVlL2lzc3Vlcy82OD5cbiAgICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL2JpdGlubi9ub2RlLWZldGNoL2Jsb2IvbWFzdGVyL3NyYy9yZXF1ZXN0LmpzI0w3NS1MNzg+XG4gICAgLy9cbiAgICBpZiAoIVsnR0VUJywgJ0hFQUQnXS5pbmNsdWRlcyhtZXRob2QpICYmICFpc1VuZGVmaW5lZChvcmlnaW5hbEJvZHkpKVxuICAgICAgYm9keSA9IGNsb25lKFxuICAgICAgICBtYXNrQnVmZmVycyB8fCBtYXNrU3RyZWFtc1xuICAgICAgICAgID8gbWFza1NwZWNpYWxUeXBlcyhvcmlnaW5hbEJvZHksIG1hc2tTcGVjaWFsVHlwZXNPcHRpb25zKVxuICAgICAgICAgIDogb3JpZ2luYWxCb2R5XG4gICAgICApO1xuICAgIGJvZHkgPSBtYXNrUHJvcHMoYm9keSwgc2FuaXRpemVGaWVsZHMsIG1hc2tQcm9wc09wdGlvbnMpO1xuICAgIGlmICghaXNVbmRlZmluZWQoYm9keSkgJiYgIWlzTnVsbChib2R5KSAmJiAhaXNTdHJpbmcoYm9keSkpXG4gICAgICBib2R5ID0gc2FmZVN0cmluZ2lmeShib2R5KTtcbiAgfVxuXG4gIC8vIHBhcnNlIHRoZSBjb29raWVzIChpZiBhbnkgd2VyZSBzZXQpXG4gIGxldCBjb29raWVzO1xuICBpZiAoaGVhZGVycyAmJiBoZWFkZXJzLmNvb2tpZSkgY29va2llcyA9IGNvb2tpZS5wYXJzZShoZWFkZXJzLmNvb2tpZSk7XG5cbiAgY29uc3QgcmVzdWx0ID0ge1xuICAgIGlkOiBpZC50b1N0cmluZygpLFxuICAgIC8vXG4gICAgLy8gTk9URTogcmVnYXJkaW5nIHRoZSBuYW1pbmcgY29udmVudGlvbiBvZiBgdGltZXN0YW1wYCwgaXQgc2VlbXMgdG8gYmUgdGhlXG4gICAgLy8gbW9zdCB3aWRlbHkgdXNlZCBhbmQgc3VwcG9ydGVkIHByb3BlcnR5IG5hbWUgYWNyb3NzIGxvZ2dpbmcgc2VydmljZXNcbiAgICAvL1xuICAgIHRpbWVzdGFtcDogaWQuZ2V0VGltZXN0YW1wKCkudG9JU09TdHJpbmcoKVxuICB9O1xuXG4gIGlmIChjdHggfHwgcmVxKSByZXN1bHQucmVxdWVzdCA9IHt9O1xuICBpZiAobWV0aG9kKSByZXN1bHQucmVxdWVzdC5tZXRob2QgPSBtZXRob2Q7XG4gIGlmIChxdWVyeSkgcmVzdWx0LnJlcXVlc3QucXVlcnkgPSBxdWVyeTtcbiAgaWYgKGhlYWRlcnMpIHJlc3VsdC5yZXF1ZXN0LmhlYWRlcnMgPSBoZWFkZXJzO1xuICBpZiAoY29va2llcykgcmVzdWx0LnJlcXVlc3QuY29va2llcyA9IGNvb2tpZXM7XG4gIGlmIChhYnNvbHV0ZVVybCkgcmVzdWx0LnJlcXVlc3QudXJsID0gYWJzb2x1dGVVcmw7XG4gIGlmICh1c2VyKSByZXN1bHQudXNlciA9IHVzZXI7XG5cbiAgaWYgKG9yaWdpbmFsQm9keSAmJiBwYXJzZUJvZHkgJiYgYm9keSAmJiAhbm9kZVJlcVtkaXNhYmxlQm9keVBhcnNpbmdTeW1ib2xdKVxuICAgIHJlc3VsdC5yZXF1ZXN0LmJvZHkgPSBib2R5O1xuXG4gIC8vXG4gIC8vIEFsc28gbm90ZSB0aGF0IHRoZXJlIGlzIG5vIHN0YW5kYXJkIGZvciBzZXR0aW5nIGEgcmVxdWVzdCByZWNlaXZlZCB0aW1lLlxuICAvL1xuICAvLyBFeGFtcGxlczpcbiAgLy9cbiAgLy8gMSkga29hLXJlcS1sb2dnZXIgdXNlcyBgY3R4LnN0YXJ0YFxuICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL0RyQmFybmFidXMva29hLXJlcS1sb2dnZXIvYmxvYi9tYXN0ZXIvc3JjL2luZGV4LnRzI0wxOTg+XG4gIC8vXG4gIC8vIDIpIG1vcmdhbiB1c2VzIGByZXEuX3N0YXJ0QXRgIGFuZCBgcmVxLl9zdGFydFRpbWVgIHdoaWNoIGFyZSBub3RcbiAgLy8gcmVxLl9zdGFydEF0ID0gcHJvY2Vzcy5ocnRpbWUoKVxuICAvLyByZXEuX3N0YXJ0VGltZSA9IG5ldyBEYXRlKClcbiAgLy8gPGh0dHBzOi8vZ2l0aHViLmNvbS9leHByZXNzanMvbW9yZ2FuL2Jsb2IvbWFzdGVyL2luZGV4LmpzI0w1MDAtTDUwOD5cbiAgLy9cbiAgLy8gMykgcGlubyB1c2VzIGBTeW1ib2woJ3N0YXJ0VGltZScpYCBidXQgaXQgZG9lcyBub3QgZXhwb3NlIGl0IGVhc2lseVxuICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL3Bpbm9qcy9waW5vLWh0dHAvaXNzdWVzLzY1PlxuICAvL1xuICAvLyA0KSByZXNwb25zZS10aW1lIGRvZXMgbm90IGV4cG9zZSBhbnl0aGluZ1xuICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL2V4cHJlc3Nqcy9yZXNwb25zZS10aW1lL3B1bGwvMTg+XG4gIC8vXG4gIC8vIFRoZXJlZm9yZSB3ZSBjcmVhdGVkIGByZXF1ZXN0LXJlY2VpdmVkYCBtaWRkbGV3YXJlIHRoYXQgaXMgcmVxdWlyZWRcbiAgLy8gdG8gYmUgdXNlZCBpbiBvcmRlciBmb3IgYHJlcXVlc3QudGltZXN0YW1wYCB0byBiZSBwb3B1bGF0ZWQgd2l0aCBJU08tODYwMVxuICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL2NhYmluanMvcmVxdWVzdC1yZWNlaXZlZD5cbiAgLy9cbiAgLy8gV2UgYWxzbyBvcGVuZWQgdGhlIGZvbGxvd2luZyBQUidzIGluIGFuIGF0dGVtcHQgdG8gbWFrZSB0aGlzIGEgZHJvcC1pbjpcbiAgLy9cbiAgLy8gKiBodHRwczovL2dpdGh1Yi5jb20vcGlub2pzL3Bpbm8taHR0cC9wdWxsLzY3XG4gIC8vICogaHR0cHM6Ly9naXRodWIuY29tL2V4cHJlc3Nqcy9tb3JnYW4vcHVsbC8yMDFcbiAgLy8gKiBodHRwczovL2dpdGh1Yi5jb20vZXhwcmVzc2pzL3Jlc3BvbnNlLXRpbWUvcHVsbC8yMFxuICAvLyAqIGh0dHBzOi8vZ2l0aHViLmNvbS9EYXRhRG9nL25vZGUtY29ubmVjdC1kYXRhZG9nL3B1bGwvN1xuICAvLyAqIGh0dHBzOi8vZ2l0aHViLmNvbS9EckJhcm5hYnVzL2tvYS1yZXEtbG9nZ2VyL3B1bGwvMlxuICAvL1xuXG4gIC8vIGFkZCByZXF1ZXN0LnRpbWVzdGFtcCAocGFyc2UgcmVxWyR4XSB2YXJpYWJsZSlcbiAgaWYgKG5vZGVSZXFbc3RhcnRUaW1lXSBpbnN0YW5jZW9mIERhdGUpXG4gICAgcmVzdWx0LnJlcXVlc3QudGltZXN0YW1wID0gbm9kZVJlcVtzdGFydFRpbWVdLnRvSVNPU3RyaW5nKCk7XG4gIGVsc2UgaWYgKHR5cGVvZiBub2RlUmVxW3N0YXJ0VGltZV0gPT09ICdudW1iZXInKVxuICAgIHJlc3VsdC5yZXF1ZXN0LnRpbWVzdGFtcCA9IG5ldyBEYXRlKG5vZGVSZXFbc3RhcnRUaW1lXSkudG9JU09TdHJpbmcoKTtcbiAgZWxzZSBpZiAodHlwZW9mIG5vZGVSZXFbcGlub0h0dHBTdGFydFRpbWVdID09PSAnbnVtYmVyJylcbiAgICByZXN1bHQucmVxdWVzdC50aW1lc3RhbXAgPSBuZXcgRGF0ZShcbiAgICAgIG5vZGVSZXFbcGlub0h0dHBTdGFydFRpbWVdXG4gICAgKS50b0lTT1N0cmluZygpO1xuICBlbHNlIGlmIChub2RlUmVxLl9zdGFydFRpbWUgaW5zdGFuY2VvZiBEYXRlKVxuICAgIHJlc3VsdC5yZXF1ZXN0LnRpbWVzdGFtcCA9IG5vZGVSZXEuX3N0YXJ0VGltZS50b0lTT1N0cmluZygpO1xuICBlbHNlIGlmICh0eXBlb2Ygbm9kZVJlcS5fc3RhcnRUaW1lID09PSAnbnVtYmVyJylcbiAgICByZXN1bHQucmVxdWVzdC50aW1lc3RhbXAgPSBuZXcgRGF0ZShub2RlUmVxLl9zdGFydFRpbWUpLnRvSVNPU3RyaW5nKCk7XG5cbiAgLy9cbiAgLy8gY29uZGl0aW9uYWxseSBhZGQgYSBgcmVzcG9uc2VgIG9iamVjdCBpZiBhbmQgb25seSBpZlxuICAvLyBgcmVzcG9uc2VIZWFkZXJzYCBvcHRpb24gd2FzIHBhc3NlZCwgYW5kIGl0IHdhcyBhIG5vbi1lbXB0eSBzdHJpbmcgb3Igb2JqZWN0XG4gIC8vXG5cbiAgaWYgKGlzT2JqZWN0KHJlc3BvbnNlSGVhZGVycykgJiYgT2JqZWN0LmtleXMocmVzcG9uc2VIZWFkZXJzKS5sZW5ndGggPiAwKSB7XG4gICAgcmVzdWx0LnJlc3BvbnNlID0ge307XG4gICAgcmVzdWx0LnJlc3BvbnNlLmhlYWRlcnMgPSBjbG9uZShyZXNwb25zZUhlYWRlcnMpO1xuICB9IGVsc2UgaWYgKGlzU3RyaW5nKHJlc3BvbnNlSGVhZGVycykpIHtcbiAgICAvLyA8aHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL2lzc3Vlcy8yODMwMj5cbiAgICBjb25zdCBwYXJzZWRIZWFkZXJzID0gaHR0cEhlYWRlcnMocmVzcG9uc2VIZWFkZXJzKTtcbiAgICByZXN1bHQucmVzcG9uc2UgPSB7fTtcbiAgICBpZiAoaXNPYmplY3QocGFyc2VkSGVhZGVycy5oZWFkZXJzKSkge1xuICAgICAgcmVzdWx0LnJlc3BvbnNlLmhlYWRlcnMgPSBwYXJzZWRIZWFkZXJzLmhlYWRlcnM7XG4gICAgICAvLyBwYXJzZSB0aGUgc3RhdHVzIGxpbmVcbiAgICAgIC8vIDxodHRwczovL3d3dy53My5vcmcvUHJvdG9jb2xzL3JmYzI2MTYvcmZjMjYxNi1zZWM2Lmh0bWwjc2VjNi4xPlxuICAgICAgaWYgKFxuICAgICAgICBpc09iamVjdChwYXJzZWRIZWFkZXJzLnZlcnNpb24pICYmXG4gICAgICAgIHR5cGVvZiBwYXJzZWRIZWFkZXJzLnZlcnNpb24ubWFqb3IgPT09ICdudW1iZXInICYmXG4gICAgICAgIHR5cGVvZiBwYXJzZWRIZWFkZXJzLnZlcnNpb24ubWlub3IgPT09ICdudW1iZXInXG4gICAgICApXG4gICAgICAgIHJlc3VsdC5yZXNwb25zZS5odHRwX3ZlcnNpb24gPSBgJHtwYXJzZWRIZWFkZXJzLnZlcnNpb24ubWFqb3J9LiR7cGFyc2VkSGVhZGVycy52ZXJzaW9uLm1pbm9yfWA7XG4gICAgICBpZiAodHlwZW9mIHBhcnNlZEhlYWRlcnMuc3RhdHVzQ29kZSA9PT0gJ251bWJlcicpXG4gICAgICAgIHJlc3VsdC5yZXNwb25zZS5zdGF0dXNfY29kZSA9IHBhcnNlZEhlYWRlcnMuc3RhdHVzQ29kZTtcbiAgICAgIGlmIChpc1N0cmluZyhwYXJzZWRIZWFkZXJzLnN0YXR1c01lc3NhZ2UpKVxuICAgICAgICByZXN1bHQucmVzcG9uc2UucmVhc29uX3BocmFzZSA9IHBhcnNlZEhlYWRlcnMuc3RhdHVzTWVzc2FnZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnJlc3BvbnNlLmhlYWRlcnMgPSBwYXJzZWRIZWFkZXJzO1xuICAgIH1cbiAgfVxuXG4gIGlmIChyZXN1bHQucmVzcG9uc2UgJiYgcmVzdWx0LnJlc3BvbnNlLmhlYWRlcnMpIHtcbiAgICByZXN1bHQucmVzcG9uc2UuaGVhZGVycyA9IG1hc2tQcm9wcyhcbiAgICAgIGhlYWRlcnNUb0xvd2VyQ2FzZShyZXN1bHQucmVzcG9uc2UuaGVhZGVycyksXG4gICAgICBzYW5pdGl6ZUhlYWRlcnMsXG4gICAgICB7IGlzSGVhZGVyczogdHJ1ZSB9XG4gICAgKTtcbiAgICBpZiAoXG4gICAgICByZXN1bHQucmVzcG9uc2UuaGVhZGVycyAmJlxuICAgICAgT2JqZWN0LmtleXMocmVzdWx0LnJlc3BvbnNlLmhlYWRlcnMpLmxlbmd0aCA9PT0gMFxuICAgICkge1xuICAgICAgZGVsZXRlIHJlc3VsdC5yZXNwb25zZTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYWRkIHJlc3BvbnNlLnRpbWVzdGFtcCAocmVzcG9uc2UgRGF0ZSBoZWFkZXIpXG4gICAgICB0cnkge1xuICAgICAgICBpZiAocmVzdWx0LnJlc3BvbnNlLmhlYWRlcnMuZGF0ZSlcbiAgICAgICAgICByZXN1bHQucmVzcG9uc2UudGltZXN0YW1wID0gbmV3IERhdGUoXG4gICAgICAgICAgICByZXN1bHQucmVzcG9uc2UuaGVhZGVycy5kYXRlXG4gICAgICAgICAgKS50b0lTT1N0cmluZygpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGRlYnVnKGVycik7XG4gICAgICB9XG5cbiAgICAgIC8vIGFkZCByZXNwb25zZS5kdXJhdGlvbiAocGFyc2VkIGZyb20gcmVzcG9uc2UgWC1SZXNwb25zZS1UaW1lIGhlYWRlcilcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChyZXN1bHQucmVzcG9uc2UuaGVhZGVyc1sneC1yZXNwb25zZS10aW1lJ10pIHtcbiAgICAgICAgICBjb25zdCBkdXJhdGlvbiA9IG1zKHJlc3VsdC5yZXNwb25zZS5oZWFkZXJzWyd4LXJlc3BvbnNlLXRpbWUnXSk7XG4gICAgICAgICAgaWYgKHR5cGVvZiBkdXJhdGlvbiA9PT0gJ251bWJlcicpIHJlc3VsdC5yZXNwb25zZS5kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgZGVidWcoZXJyKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBhZGQgcmVxdWVzdCdzIGlkIGlmIGF2YWlsYWJsZSBmcm9tIGByZXEuaWRgXG4gIGxldCByZXF1ZXN0SWQ7XG4gIGlmIChjdHgpIHtcbiAgICBpZiAoaXNTdHJpbmcoY3R4LmlkKSkgcmVxdWVzdElkID0gY3R4LmlkO1xuICAgIGVsc2UgaWYgKGlzU3RyaW5nKGN0eC5yZXF1ZXN0LmlkKSkgcmVxdWVzdElkID0gY3R4LnJlcXVlc3QuaWQ7XG4gICAgZWxzZSBpZiAoaXNTdHJpbmcoY3R4LnJlcS5pZCkpIHJlcXVlc3RJZCA9IGN0eC5yZXEuaWQ7XG4gICAgZWxzZSBpZiAoaXNTdHJpbmcoY3R4LnN0YXRlLnJlcUlkKSkgcmVxdWVzdElkID0gY3R4LnN0YXRlLnJlcUlkO1xuICAgIGVsc2UgaWYgKGlzU3RyaW5nKGN0eC5zdGF0ZS5pZCkpIHJlcXVlc3RJZCA9IGN0eC5zdGF0ZS5pZDtcbiAgfSBlbHNlIGlmIChyZXEgJiYgaXNTdHJpbmcocmVxLmlkKSkge1xuICAgIHJlcXVlc3RJZCA9IHJlcS5pZDtcbiAgfVxuXG4gIC8vIFRPRE86IHdlIHNob3VsZCBwcm9iYWJseSB2YWxpZGF0ZSB0aGlzIGlkIHNvbWVob3dcbiAgLy8gKGUuZy4gbGlrZSB3ZSBkbyB3aXRoIGNoZWNraW5nIGlmIGN1aWQgb3IgdXVpZCBvciBvYmplY3RpZClcbiAgaWYgKHJlcXVlc3RJZCkgcmVzdWx0LnJlcXVlc3QuaWQgPSByZXF1ZXN0SWQ7XG4gIGVsc2UgaWYgKGhlYWRlcnMgJiYgaGVhZGVyc1sneC1yZXF1ZXN0LWlkJ10pXG4gICAgcmVzdWx0LnJlcXVlc3QuaWQgPSBoZWFkZXJzWyd4LXJlcXVlc3QtaWQnXTtcblxuICAvLyBhZGQgaHR0cFZlcnNpb24gaWYgcG9zc2libGUgKHNlcnZlci1zaWRlIG9ubHkpXG4gIGNvbnN0IHsgaHR0cFZlcnNpb24sIGh0dHBWZXJzaW9uTWFqb3IsIGh0dHBWZXJzaW9uTWlub3IgfSA9IG5vZGVSZXE7XG5cbiAgaWYgKGlzU3RyaW5nKGh0dHBWZXJzaW9uKSkgcmVzdWx0LnJlcXVlc3QuaHR0cF92ZXJzaW9uID0gaHR0cFZlcnNpb247XG4gIGVsc2UgaWYgKFxuICAgICh0eXBlb2YgaHR0cFZlcnNpb25NYWpvciA9PT0gJ251bWJlcicgJiZcbiAgICAgIHR5cGVvZiBodHRwVmVyc2lvbk1pbm9yID09PSAnbnVtYmVyJykgfHxcbiAgICAoaXNTdHJpbmcoaHR0cFZlcnNpb25NYWpvcikgJiYgaXNTdHJpbmcoaHR0cFZlcnNpb25NaW5vcikpXG4gIClcbiAgICByZXN1bHQucmVxdWVzdC5odHRwX3ZlcnNpb24gPSBgJHtodHRwVmVyc2lvbk1ham9yfS4ke2h0dHBWZXJzaW9uTWlub3J9YDtcblxuICAvLyBwYXJzZSBgcmVxLmZpbGVgIGFuZCBgcmVxLmZpbGVzYCBmb3IgbXVsdGVyIHYxLnggYW5kIHYyLnhcbiAgaWYgKHBhcnNlRmlsZXMgJiYgIW5vZGVSZXFbZGlzYWJsZUZpbGVQYXJzaW5nU3ltYm9sXSkge1xuICAgIC8vIGtvYS1tdWx0ZXJAMS54IGJpbmRlZCB0byBgY3R4LnJlcWBcbiAgICAvLyBhbmQgdGhlbiBrb2EtbXVsdGVyIHdhcyBmb3JrZWQgYnkgQG5pZnR5bGV0dHVjZSB0byBAa29hanMvbXVsdGVyXG4gICAgLy8gYW5kIHRoZSAyLjAuMCByZWxlYXNlIGNoYW5nZWQgaXQgc28gaXQgdXNlcyBgY3R4LmZpbGVgIGFuZCBgY3R4LmZpbGVzYFxuICAgIC8vIChzbyBpdCBkb2Vzbid0IGJpbmQgdG8gdGhlIGBjdHgucmVxYCBOb2RlIG9yaWdpbmFsIHJlcXVlc3Qgb2JqZWN0XG4gICAgLy8gPGh0dHBzOi8vZ2l0aHViLmNvbS9rb2EtbW9kdWxlcy9tdWx0ZXIvcHVsbC8xNT5cbiAgICBsZXQgZmlsZTtcbiAgICBsZXQgZmlsZXM7XG4gICAgaWYgKGN0eCkge1xuICAgICAgZmlsZSA9IGN0eC5maWxlIHx8IGN0eC5yZXF1ZXN0LmZpbGUgfHwgY3R4LnJlcS5maWxlO1xuICAgICAgZmlsZXMgPSBjdHguZmlsZXMgfHwgY3R4LnJlcXVlc3QuZmlsZXMgfHwgY3R4LnJlcS5maWxlcztcbiAgICB9IGVsc2UgaWYgKHJlcSkge1xuICAgICAgZmlsZSA9IHJlcS5maWxlO1xuICAgICAgZmlsZXMgPSByZXEuZmlsZXM7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBmaWxlID09PSAnb2JqZWN0JylcbiAgICAgIHJlc3VsdC5yZXF1ZXN0LmZpbGUgPSBzYWZlU3RyaW5naWZ5KFxuICAgICAgICBjbG9uZShtYXNrU3BlY2lhbFR5cGVzKGZpbGUsIG1hc2tTcGVjaWFsVHlwZXNPcHRpb25zKSlcbiAgICAgICk7XG4gICAgaWYgKHR5cGVvZiBmaWxlcyA9PT0gJ29iamVjdCcpXG4gICAgICByZXN1bHQucmVxdWVzdC5maWxlcyA9IHNhZmVTdHJpbmdpZnkoXG4gICAgICAgIGNsb25lKG1hc2tTcGVjaWFsVHlwZXMoZmlsZXMsIG1hc2tTcGVjaWFsVHlwZXNPcHRpb25zKSlcbiAgICAgICk7XG4gIH1cblxuICByZXN1bHQuZHVyYXRpb24gPSBjb252ZXJ0SHJ0aW1lKGhydGltZShzdGFydCkpLm1pbGxpc2Vjb25kcztcblxuICByZXR1cm4gcmVzdWx0O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBwYXJzZVJlcXVlc3Q7XG4iXX0=